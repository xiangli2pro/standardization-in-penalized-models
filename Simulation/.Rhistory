n <- 10000 # number of observations
pn <- 3 # number of covariates
mu <- rep(0,pn)
Sigma <- diag(rep(1,pn))
set.seed(2020)
## true coefficients
beta_0 <- 4
beta_p <- c(2,2,-2)
## function: return standardized coefficients under different standarization methods
coeff_func_p <- function(beta_0, beta_p, n, mu,Sigma, p=0.5){
# generate latent data X
X <- mvrnorm(n, mu=mu, Sigma = Sigma) %>% as.data.frame()
colnames(X) <- paste0("X",c(1,2,3))
# true model
linear_part <- beta_0 + (as.matrix(X) %*% beta_p)
Y <- rbinom(nrow(X),size = 1, prob = ilogit(linear_part))
# generate observed data (dichotomize X2 to Z2)
Z <- data.frame(Z1=X$X1,
Z2=ifelse(X$X2<=qnorm(p,mu[2],sd = sqrt(Sigma[2,2])),0,1),
Z3=factor(ifelse(X$X3<=qnorm(1/3,mu[3],sd = sqrt(Sigma[3,3])),"f0",
ifelse(X$X3<=qnorm(2/3,mu[3],sd = sqrt(Sigma[3,3])),"f1","f2")),levels = paste0("f",c(0,1,2)))
)
# encode Z
dummies <- dummyVars(~., data = Z, fullRank = T)
Z_dum <- predict(dummies,Z)
ZY_data <- cbind(Y,Z_dum)
ZY_data_prior <- cbind(Y,Z)
# glm model on data with no standardization
lg_mod1 <- ZY_data %>% as.data.frame() %>% glm(Y~., data = ., family = "binomial")
# glm model on data with Z-score standardization
lg_mod2 <- ZY_data %>% as.data.frame() %>% mutate_at(c(2:5),function(x) x/sd(x)) %>% glm(Y~., data = ., family = "binomial")
# glm model on data with Gelman standardization
lg_mod3 <- ZY_data %>% as.data.frame() %>% mutate_at(c(2),function(x) x/2/sd(x)) %>% glm(Y~., data = ., family = "binomial")
# glm model on data with Min-max standardization
lg_mod4 <- ZY_data %>% as.data.frame() %>% mutate_at(c(2),function(x) (x-min(x))/(max(x)-min(x))) %>% glm(Y~., data = ., family = "binomial")
# glm model on data with Proposed standardization, no 2sd scale
lg_mod5 <- ZY_data_prior %>%
mutate(Z1=ifelse(Z1<=quantile(Z1,probs = mean(Z2==0)),0,1)) %>%
mutate_at(c(4),function(x) multi_fix(x)) %>%
glm(Y~., data = ., family = "binomial")
# glm model on data with Proposed standardization, with 2sd scale
lg_mod6 <- ZY_data_prior %>%
mutate(Z1=ifelse(Z1<=quantile(Z1,probs = mean(Z2==0)),0,1)) %>%
mutate_at(c(4),function(x) multi_fix(x)) %>%
mutate_at(c(2:4), function(x) return(x/2/sd(x))) %>%
glm(Y~., data = ., family = "binomial")
# get coefficients from all models
coef_stat <- lapply(paste0("lg_mod",c(1:6)), function(x) summary(get(x))$coefficients[,1]) %>% unlist()
return(c(coef_stat))
}
## Run 2000 simulations
## open parallel computing clusters
cl <- makeForkCluster(2)
registerDoParallel(cl)
sim_num <- 2000
# data when X_bi is dichotomized by p=0.5
system.time(res_p0.5 <- foreach(m=c(1:sim_num),.combine = "rbind",.packages = c("glmnet","dplyr", "MASS")) %dopar%
coeff_func_p(beta_0, beta_p,n, mu,Sigma, p=0.5))
# data when X_bi is dichotomized by p=0.7
system.time(res_p0.7 <- foreach(m=c(1:sim_num),.combine = "rbind",.packages = c("glmnet","dplyr", "MASS")) %dopar%
coeff_func_p(beta_0, beta_p,n, mu,Sigma, p=0.7))
# data when X_bi is dichotomized by p=0.9
system.time(res_p0.9 <- foreach(m=c(1:sim_num),.combine = "rbind",.packages = c("glmnet","dplyr", "MASS")) %dopar%
coeff_func_p(beta_0, beta_p,n, mu,Sigma, p=0.9))
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(kableExtra)
library(dplyr)
load("simulation1_data/res_ratio_t2.rda")
load("simulation1_data/res_coef_t2.rda")
res_ratio_t2 %>% kable() %>%
kable_styling(full_width = T,bootstrap_options = c("striped", "hover")) %>%
pack_rows("None standardization", 1, 1, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("1 SD standardization", 2, 2, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("Andrew Gelman", 3, 3, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("Min-max", 4, 4, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("New standardization, no 2sd", 5, 5, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("New standardization, with 2sd", 6, 6, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("New standardization, no 2sd", 7, 7, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("New standardization, with 2sd", 8, 8, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("New standardization, no 2sd", 9, 9, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("New standardization, with 2sd", 10, 10, label_row_css = "background-color: white; color: blue;") %>%
scroll_box(width = "100%", height = "500px")
res_coef_t2 %>% kable() %>%
kable_styling(full_width = T,bootstrap_options = c("striped", "hover")) %>%
pack_rows("None standardization", 1, 5, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("1 SD standardization", 6, 10, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("Andrew Gelman", 11, 15, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("Min-max", 16, 20, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("New standardization, no 2sd", 21, 24, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("New standardization, with 2sd", 25, 28, label_row_css = "background-color: white; color: blue;") %>%
scroll_box(width = "100%", height = "500px")
res_ratio_t2 %>% %>%
res_ratio_t2 %>%
kbl(caption = "Recreating booktabs style table") %>%
kable_classic(full_width = F, html_font = "Cambria") %>%
pack_rows("None standardization", 1, 1, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("1 SD standardization", 2, 2, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("Andrew Gelman", 3, 3, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("Min-max", 4, 4, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("New standardization, no 2sd", 5, 5, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("New standardization, with 2sd", 6, 6, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("New standardization, no 2sd", 7, 7, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("New standardization, with 2sd", 8, 8, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("New standardization, no 2sd", 9, 9, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("New standardization, with 2sd", 10, 10, label_row_css = "background-color: white; color: blue;") %>%
scroll_box(width = "100%", height = "500px")
res_coef_t2 %>% kable() %>%
kable_styling(full_width = T,bootstrap_options = c("striped", "hover")) %>%
pack_rows("None standardization", 1, 5, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("1 SD standardization", 6, 10, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("Andrew Gelman", 11, 15, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("Min-max", 16, 20, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("New standardization, no 2sd", 21, 24, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("New standardization, with 2sd", 25, 28, label_row_css = "background-color: white; color: blue;")
res_coef_t2 %>%
kbl(caption = "Recreating booktabs style table") %>%
kable_classic(full_width = F, html_font = "Cambria") %>%
pack_rows("None standardization", 1, 5, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("1 SD standardization", 6, 10, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("Andrew Gelman", 11, 15, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("Min-max", 16, 20, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("New standardization, no 2sd", 21, 24, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("New standardization, with 2sd", 25, 28, label_row_css = "background-color: white; color: blue;")
res_ratio_t2 %>%
kbl(caption = "Recreating booktabs style table") %>%
kable_classic(full_width = F, html_font = "Cambria") %>%
pack_rows("None standardization", 1, 1, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("1 SD standardization", 2, 2, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("Andrew Gelman", 3, 3, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("Min-max", 4, 4, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("New standardization, no 2sd", 5, 5, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("New standardization, with 2sd", 6, 6, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("New standardization, no 2sd", 7, 7, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("New standardization, with 2sd", 8, 8, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("New standardization, no 2sd", 9, 9, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("New standardization, with 2sd", 10, 10, label_row_css = "background-color: white; color: blue;")
res_coef_t2 %>%
kbl(caption = "Recreating booktabs style table") %>%
kable_classic(full_width = F, html_font = "Cambria") %>%
pack_rows("None standardization", 1, 5, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("1 SD standardization", 6, 10, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("Andrew Gelman", 11, 15, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("Min-max", 16, 20, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("New standardization, no 2sd", 21, 24, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("New standardization, with 2sd", 25, 28, label_row_css = "background-color: white; color: blue;")
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(kableExtra)
library(dplyr)
load("simulation1_data/res_ratio_t2.rda")
load("simulation1_data/res_coef_t2.rda")
res_ratio_t2 %>%
kbl(caption = "ratio of Z_cont coefficient to Z_bi coefficient") %>%
kable_classic(full_width = F, html_font = "Cambria") %>%
pack_rows("None standardization", 1, 1, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("1 SD standardization", 2, 2, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("Andrew Gelman", 3, 3, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("Min-max", 4, 4, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("New standardization, no 2sd", 5, 5, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("New standardization, with 2sd", 6, 6, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("New standardization, no 2sd", 7, 7, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("New standardization, with 2sd", 8, 8, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("New standardization, no 2sd", 9, 9, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("New standardization, with 2sd", 10, 10, label_row_css = "background-color: white; color: blue;")
res_coef_t2 %>%
kbl(caption = "standardized coefficients") %>%
kable_classic(full_width = F, html_font = "Cambria") %>%
pack_rows("None standardization", 1, 5, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("1 SD standardization", 6, 10, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("Andrew Gelman", 11, 15, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("Min-max", 16, 20, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("New standardization, no 2sd", 21, 24, label_row_css = "background-color: white; color: blue;") %>%
pack_rows("New standardization, with 2sd", 25, 28, label_row_css = "background-color: white; color: blue;")
# create row names
row_name <- c(rep(c("Intercept","Z_cont","Z_bi","Z_multi_f1","Z_multi_f2"),4),
rep(c("Intercept","Z_cont","Z_bi","Z_multi"),2))
View(res_coef_t2)
# add coeff. names as a new column
res_coef_t2[1,] = row_name
# add coeff. names as a new column
res_coef_t2[,1] = row_name
View(res_ratio_t2)
# save data
save(res_coef_t2,file = "simulation1_data/res_coef_t2.rda")
View(res_ratio_t2)
View(res_coef_t2)
load("~/Dropbox/Dissertation/Project2-Opioid/GitHub/Simulation/simulation2_data/res_norm_indep1.rda")
res_norm_indep <- res_norm_indep1
save(res_norm_indep,file = "simulation2_data/res_norm_indep.rda")
load("~/Dropbox/Dissertation/Project2-Opioid/GitHub/Simulation/simulation2_data/res_norm_part1.rda")
load("~/Dropbox/Dissertation/Project2-Opioid/GitHub/Simulation/simulation2_data/res_norm_part2.rda")
res_norm_part <- rbind(res_norm_part1, res_norm_part2)
View(res_norm_part1)
View(res_norm_part)
load("~/Dropbox/Dissertation/Project2-Opioid/GitHub/Simulation/simulation2_data/res_norm_indep.rda")
View(res_norm_indep)
res_norm_part <- c(res_norm_part1,res_norm_part2)
save(res_norm_part,file = "simulation2_data/res_norm_part.rda")
load("~/Dropbox/Dissertation/Project2-Opioid/GitHub/Simulation/simulation2_data/res_norm_all.rda")
summary_func <- function(res_data){
# convert to matrix
res <- rbind(do.call(rbind,res_data))
# data with lambda_1se
res_1se <- res[,c(seq(1,24,by=6),seq(1,24,by=6)+1,seq(1,24,by=6)+2,
seq(1,24,by=6)+3,seq(1,24,by=6)+4,seq(1,24,by=6)+5, 49:(49+71))]
res_1se_m <- colMeans(res_1se)
res_1se_sd <- apply(res_1se,2,sd)
# data with lambda_min
res_min <- res[,c(24+c(seq(1,24,by=6),seq(1,24,by=6)+1,seq(1,24,by=6)+2,
seq(1,24,by=6)+3,seq(1,24,by=6)+4,seq(1,24,by=6)+5), (49+71+1):192)]
res_min_m <- colMeans(res_min)
res_min_sd <- apply(res_min,2,sd)
# rearrange table of lambda_1se
res_1se_m_df <- data.frame(Model1=c(res_1se_m[c(c(1:4),
c(25:(25+11)) )]),
Model2=c(res_1se_m[c(4+c(1:4),
12+c(25:(25+11)) )]),
Model3=c(res_1se_m[c(4*2+c(1:4),
12*2+c(25:(25+11)) )]),
Model4=c(res_1se_m[c(4*3+c(1:4),
12*3+c(25:(25+11)) )]),
Model5=c(res_1se_m[c(4*4+c(1:4),
12*4+c(25:(25+11)) )]),
Model6=c(res_1se_m[c(4*5+c(1:4),
12*5+c(25:(25+11)) )]))
res_1se_m_df[11:16,] <- 1- res_1se_m_df[11:16,]
res_1se_m_df <- res_1se_m_df %>% round(2) %>%  format(2) %>% as.matrix()
res_1se_sd_df <- data.frame(Model1=c(res_1se_sd[c(c(1:4),
c(25:(25+11)) )]),
Model2=c(res_1se_sd[c(4+c(1:4),
12+c(25:(25+11)) )]),
Model3=c(res_1se_sd[c(4*2+c(1:4),
12*2+c(25:(25+11)) )]),
Model4=c(res_1se_sd[c(4*3+c(1:4),
12*3+c(25:(25+11)) )]),
Model5=c(res_1se_sd[c(4*4+c(1:4),
12*4+c(25:(25+11)) )]),
Model6=c(res_1se_sd[c(4*5+c(1:4),
12*5+c(25:(25+11)) )])) %>%
round(2) %>% format(2) %>% as.matrix()
# combine mean and sd
res_1se_table <- matrix(paste0(res_1se_m_df, " (", res_1se_sd_df, ")"), nrow = nrow(res_1se_sd_df), byrow = FALSE)
# rearrange table of lambda_min
res_min_m_df <- data.frame(Model1=c(res_min_m[c(c(1:4),
c(25:(25+11)) )]),
Model2=c(res_min_m[c(4+c(1:4),
12+c(25:(25+11)) )]),
Model3=c(res_min_m[c(4*2+c(1:4),
12*2+c(25:(25+11)) )]),
Model4=c(res_min_m[c(4*3+c(1:4),
12*3+c(25:(25+11)) )]),
Model5=c(res_min_m[c(4*4+c(1:4),
12*4+c(25:(25+11)) )]),
Model6=c(res_min_m[c(4*5+c(1:4),
12*5+c(25:(25+11)) )]))
res_min_m_df[11:16,] <- 1- res_min_m_df[11:16,]
res_min_m_df <- res_min_m_df %>% round(2) %>%  format(2) %>% as.matrix()
res_min_sd_df <- data.frame(Model1=c(res_min_sd[c(c(1:4),
c(25:(25+11)) )]),
Model2=c(res_min_sd[c(4+c(1:4),
12+c(25:(25+11)) )]),
Model3=c(res_min_sd[c(4*2+c(1:4),
12*2+c(25:(25+11)) )]),
Model4=c(res_min_sd[c(4*3+c(1:4),
12*3+c(25:(25+11)) )]),
Model5=c(res_min_sd[c(4*4+c(1:4),
12*4+c(25:(25+11)) )]),
Model6=c(res_min_sd[c(4*5+c(1:4),
12*5+c(25:(25+11)) )])) %>% round(2) %>% format(2) %>% as.matrix()
res_min_table <- matrix(paste0(res_min_m_df, " (", res_min_sd_df, ")"), nrow = nrow(res_min_sd_df), byrow = FALSE)
# setup names
rownames(res_1se_table) <- c("lambda","sensitivity","specificity","miss-class",
"Z1_cont","Z2_bi_p=0.5","Z3_bi_p=0.7","Z4_bi_p=0.9",
"Z5_multi_p=1/3","Z6_multi_p=1/4",
"Z7_cont","Z8_bi_p=0.5","Z9_bi_p=0.7","Z10_bi_p=0.9",
"Z11_multi_p=1/3","Z12_multi_p=1/4")
rownames(res_min_table) <- c("lambda","sensitivity","specificity","miss-class",
"Z1_cont","Z2_bi_p=0.5","Z3_bi_p=0.7","Z4_bi_p=0.9",
"Z5_multi_p=1/3","Z6_multi_p=1/4",
"Z7_cont","Z8_bi_p=0.5","Z9_bi_p=0.7","Z10_bi_p=0.9",
"Z11_multi_p=1/3","Z12_multi_p=1/4")
summary_table <- cbind(res_1se_table[,c(1,6,2:5)],res_min_table[,c(1,6,2:5)])
colnames(summary_table) <- rep(c("None","Z-score","AG","Min-max","Proposed","Proposed-2sd"),2)
return(summary_table)
}
test <- summary_func(res_norm_all)
View(test)
load("/Users/xiangli/Dropbox/Dissertation/Project2-Opioid/2021/02122021/simulation_corr/tb_exp.rda")
View(tb_exp)
load("/Users/xiangli/Dropbox/Dissertation/Project2-Opioid/2021/02122021/simulation_corr/tb_gamma.rda")
View(tb_gamma)
load("/Users/xiangli/Dropbox/Dissertation/Project2-Opioid/2021/02122021/simulation_corr/tb_norm_indep.rda")
View(tb_norm_indep)
load("/Users/xiangli/Dropbox/Dissertation/Project2-Opioid/2021/02122021/simulation_corr/tb_norm_all.rda")
load("/Users/xiangli/Dropbox/Dissertation/Project2-Opioid/2021/02122021/simulation_corr/tb_norm_part.rda")
save(tb_norm_indep, tb_norm_part, tb_norm_all, tb_exp, tb_gamma, file="simulation2_data/summary_tables")
save(tb_norm_indep, tb_norm_part, tb_norm_all, tb_exp, tb_gamma, file="simulation2_data/summary_tables.rda")
load("~/Dropbox/Dissertation/Project2-Opioid/GitHub/Simulation/simulation2_data/summary_tables.rda")
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(kableExtra)
library(dplyr)
load("simulation2_data/summary_tables.rda")
cbind(tb_norm_indep[-c(1,4),c(1:4,6)],tb_norm_part[-c(1,4),c(1:4,6)], tb_norm_all[-c(1,4),c(1:4,6)]) %>% as.data.frame() %>% kbl(caption = 'simulations: independent or correlated normal latent variables', bold=T) %>%
column_spec(c(6,11), border_right = T) %>%
add_header_above(c(" "=1, 'S1: latent variables are independent'=5, 'S2: only true latent variables are correlated(0.3)'=5, 'S3: both true and noise latent variables are correlated(0.3)'=5)) %>%
kable_classic(full_width = F, html_font = "Cambria",lightable_options = c("hover"))%>%
row_spec(3,background = 'yellow') %>%
row_spec(4:6, background = 'pink') %>%
row_spec(7:8, background = 'lightblue') %>%
pack_rows("\n", 3,8) %>%
pack_rows("\n", 9,14) %>%
footnote(general = "Findings from the table",
number = c("more continuous variables are selected when use None standardization than that of other methods",
"among all standardizations, the selection rate of binary with percentage of one close to 0.9 is highest in the case of using Z-score",
"when use Min-max method, the multi-category variables have highest selection rates, compared to other approaches",
"the Proposed strategy has relative low variable sensitivity but highest variable specificity, and the fact that applying proposed standardization on real data gives highest AUC score and lowest BIC value implies that the proposed method is able to select most of the important features as well as filter out negative effects by ignoring most of the noise variables \n \n",
"variable sensitivity and specificity decreased for all mehtods in correlated case, but specificity of proposed method does not change much",
"in independent case, selection rate of multi-category variables tend to be lower than binary(0.5/0.7), in correlated case, selection rate of multi-category tend to be higher than binary(0.5/0.7)"))
load("simulation_corr/tb_exp.rda")
tb_exp[-c(1,4),c(1:4,6)] %>% as.data.frame() %>% kbl(caption = 'latent exp distribution', bold=T) %>%
kable_classic(full_width = F, html_font = "Cambria",lightable_options = c("hover"))%>%
row_spec(3,background = 'yellow') %>%
row_spec(4:6, background = 'pink') %>%
row_spec(7:8, background = 'lightblue') %>%
pack_rows("\n", 3,8) %>%
pack_rows("\n", 9,14)
tb_gamma[-c(1,4),c(1:4,6)] %>% as.data.frame() %>% kbl(caption = 'latent gamma distribution', bold=T) %>%
kable_classic(full_width = F, html_font = "Cambria",lightable_options = c("hover"))%>%
row_spec(3,background = 'yellow') %>%
row_spec(4:6, background = 'pink') %>%
row_spec(7:8, background = 'lightblue') %>%
pack_rows("\n", 3,8) %>%
pack_rows("\n", 9,14)
cbind(tb_norm_indep[-c(1,4),c(1:4,6)],tb_norm_part[-c(1,4),c(1:4,6)], tb_norm_all[-c(1,4),c(1:4,6)]) %>% as.data.frame() %>% kbl(caption = 'simulations: independent or correlated normal latent variables', bold=T) %>%
column_spec(c(6,11), border_right = T) %>%
add_header_above(c(" "=1, 'S1: latent variables are independent'=5, 'S2: only true latent variables are correlated(0.3)'=5, 'S3: both true and noise latent variables are correlated(0.3)'=5)) %>%
kable_classic(full_width = F, html_font = "Cambria",lightable_options = c("hover"))%>%
row_spec(3,background = 'yellow') %>%
row_spec(4:6, background = 'pink') %>%
row_spec(7:8, background = 'lightblue') %>%
pack_rows("\n", 3,8) %>%
pack_rows("\n", 9,14) %>%
footnote(general = "Findings from the table",
number = c("more continuous variables are selected when use None standardization than that of other methods",
"among all standardizations, the selection rate of binary with percentage of one close to 0.9 is highest in the case of using Z-score",
"when use Min-max method, the multi-category variables have highest selection rates, compared to other approaches",
"the Proposed strategy has relative low variable sensitivity but highest variable specificity, and the fact that applying proposed standardization on real data gives highest AUC score and lowest BIC value implies that the proposed method is able to select most of the important features as well as filter out negative effects by ignoring most of the noise variables \n \n",
"variable sensitivity and specificity decreased for all mehtods in correlated case, but specificity of proposed method does not change much",
"in independent case, selection rate of multi-category variables tend to be lower than binary(0.5/0.7), in correlated case, selection rate of multi-category tend to be higher than binary(0.5/0.7)"))
tb_gamma[-c(1,4),c(1:4,6)] %>% as.data.frame() %>% kbl(caption = 'latent gamma distribution', bold=T) %>%
kable_classic(full_width = F, html_font = "Cambria",lightable_options = c("hover"))%>%
row_spec(3,background = 'yellow') %>%
row_spec(4:6, background = 'pink') %>%
row_spec(7:8, background = 'lightblue') %>%
pack_rows("\n", 3,8) %>%
pack_rows("\n", 9,14)
cbind(tb_norm_indep[-c(1,4),c(1:4,6)],tb_norm_part[-c(1,4),c(1:4,6)], tb_norm_all[-c(1,4),c(1:4,6)]) %>% as.data.frame() %>% kbl(caption = 'simulations: independent or correlated normal latent variables', bold=T) %>%
column_spec(c(6,11), border_right = T)
# %>%
#   add_header_above(c(" "=1, 'S1: latent variables are independent'=5, 'S2: only true latent variables are correlated(0.3)'=5, 'S3: both true and noise latent variables are correlated(0.3)'=5)) %>%
#   kable_classic(full_width = F, html_font = "Cambria",lightable_options = c("hover"))%>%
#   row_spec(3,background = 'yellow') %>%
#   row_spec(4:6, background = 'pink') %>%
#   row_spec(7:8, background = 'lightblue') %>%
#   pack_rows("\n", 3,8) %>%
#   pack_rows("\n", 9,14) %>%
#   footnote(general = "Findings from the table",
#            number = c("more continuous variables are selected when use None standardization than that of other methods",
#             "among all standardizations, the selection rate of binary with percentage of one close to 0.9 is highest in the case of using Z-score",
#             "when use Min-max method, the multi-category variables have highest selection rates, compared to other approaches",
#             "the Proposed strategy has relative low variable sensitivity but highest variable specificity, and the fact that applying proposed standardization on real data gives highest AUC score and lowest BIC value implies that the proposed method is able to select most of the important features as well as filter out negative effects by ignoring most of the noise variables \n \n",
#             "variable sensitivity and specificity decreased for all mehtods in correlated case, but specificity of proposed method does not change much",
#             "in independent case, selection rate of multi-category variables tend to be lower than binary(0.5/0.7), in correlated case, selection rate of multi-category tend to be higher than binary(0.5/0.7)"))
cbind(tb_norm_indep[-c(1,4),c(1:4,6)],tb_norm_part[-c(1,4),c(1:4,6)], tb_norm_all[-c(1,4),c(1:4,6)]) %>% as.data.frame() %>% kbl(caption = 'simulations: independent or correlated normal latent variables', bold=T) %>%
column_spec(c(6,11), border_right = T)
# %>%
#   add_header_above(c(" "=1, 'S1: latent variables are independent'=5, 'S2: only true latent variables are correlated(0.3)'=5, 'S3: both true and noise latent variables are correlated(0.3)'=5)) %>%
#   kable_classic(full_width = F, html_font = "Cambria",lightable_options = c("hover"))%>%
#   row_spec(3,background = 'yellow') %>%
#   row_spec(4:6, background = 'pink') %>%
#   row_spec(7:8, background = 'lightblue') %>%
#   pack_rows("\n", 3,8) %>%
#   pack_rows("\n", 9,14) %>%
#   footnote(general = "Findings from the table",
#            number = c("more continuous variables are selected when use None standardization than that of other methods",
#             "among all standardizations, the selection rate of binary with percentage of one close to 0.9 is highest in the case of using Z-score",
#             "when use Min-max method, the multi-category variables have highest selection rates, compared to other approaches",
#             "the Proposed strategy has relative low variable sensitivity but highest variable specificity, and the fact that applying proposed standardization on real data gives highest AUC score and lowest BIC value implies that the proposed method is able to select most of the important features as well as filter out negative effects by ignoring most of the noise variables \n \n",
#             "variable sensitivity and specificity decreased for all mehtods in correlated case, but specificity of proposed method does not change much",
#             "in independent case, selection rate of multi-category variables tend to be lower than binary(0.5/0.7), in correlated case, selection rate of multi-category tend to be higher than binary(0.5/0.7)"))
tb_exp[-c(1,4),c(1:4,6)] %>% as.data.frame() %>% kbl(caption = 'latent exp distribution', bold=T) %>%
kable_classic(full_width = F,lightable_options = c("hover"))%>%
row_spec(3,background = 'yellow') %>%
row_spec(4:6, background = 'pink') %>%
row_spec(7:8, background = 'lightblue') %>%
pack_rows("\n", 3,8) %>%
pack_rows("\n", 9,14)
tb_gamma[-c(1,4),c(1:4,6)] %>% as.data.frame() %>% kbl(caption = 'latent gamma distribution', bold=T) %>%
kable_classic(full_width = F,lightable_options = c("hover"))%>%
row_spec(3,background = 'yellow') %>%
row_spec(4:6, background = 'pink') %>%
row_spec(7:8, background = 'lightblue') %>%
pack_rows("\n", 3,8) %>%
pack_rows("\n", 9,14)
install.packages("xcolor")
tb_exp[-c(1,4),c(1:4,6)] %>%
as.data.frame() %>%
kbl(caption = 'latent exp distribution', bold=T, format = "latex")
tb_exp[-c(1,4),c(1:4,6)] %>%
as.data.frame() %>%
kbl(caption = 'latent exp distribution', format = "latex")
# %>%
#   kable_classic(full_width = F,lightable_options = c("hover"))%>%
#   row_spec(3,background = 'yellow') %>%
#   row_spec(4:6, background = 'pink') %>%
#   row_spec(7:8, background = 'lightblue') %>%
#   pack_rows("\n", 3,8) %>%
#   pack_rows("\n", 9,14)
tb_exp[-c(1,4),c(1:4,6)] %>%
as.data.frame() %>%
kbl(caption = 'latent exp distribution', format = "latex") %>%
kable_classic(full_width = F,lightable_options = c("hover"))%>%
row_spec(3,background = 'yellow') %>%
row_spec(4:6, background = 'pink') %>%
row_spec(7:8, background = 'lightblue') %>%
pack_rows("\n", 3,8) %>%
pack_rows("\n", 9,14)
cbind(tb_norm_indep[-c(1,4),c(1:4,6)],tb_norm_part[-c(1,4),c(1:4,6)], tb_norm_all[-c(1,4),c(1:4,6)]) %>%
as.data.frame() %>%
kbl(caption = 'simulations: independent or correlated normal latent variables') %>%
column_spec(c(6,11), border_right = T) %>%
add_header_above(c(" "=1, 'S1: latent variables are independent'=5, 'S2: only true latent variables are correlated(0.3)'=5, 'S3: both true and noise latent variables are correlated(0.3)'=5)) %>%
# kable_classic(full_width = F, html_font = "Cambria",lightable_options = c("hover"))%>%
row_spec(3,background = 'yellow') %>%
row_spec(4:6, background = 'pink') %>%
row_spec(7:8, background = 'lightblue') %>%
pack_rows("\n", 3,8) %>%
pack_rows("\n", 9,14) %>%
footnote(general = "Findings from the table",
number = c("more continuous variables are selected when use None standardization than that of other methods",
"among all standardizations, the selection rate of binary with percentage of one close to 0.9 is highest in the case of using Z-score",
"when use Min-max method, the multi-category variables have highest selection rates, compared to other approaches",
"the Proposed strategy has relative low variable sensitivity but highest variable specificity, and the fact that applying proposed standardization on real data gives highest AUC score and lowest BIC value implies that the proposed method is able to select most of the important features as well as filter out negative effects by ignoring most of the noise variables \n \n",
"variable sensitivity and specificity decreased for all mehtods in correlated case, but specificity of proposed method does not change much",
"in independent case, selection rate of multi-category variables tend to be lower than binary(0.5/0.7), in correlated case, selection rate of multi-category tend to be higher than binary(0.5/0.7)"))
cbind(tb_norm_indep[-c(1,4),c(1:4,6)],
tb_norm_part[-c(1,4),c(1:4,6)],
tb_norm_all[-c(1,4),c(1:4,6)]) %>%
as.data.frame() %>%
kbl(caption = 'simulations: independent or correlated normal latent variables') %>%
column_spec(c(6,11), border_right = T) %>%
add_header_above(c(" "=1, 'S1: latent variables are independent'=5, 'S2: only true latent variables are correlated(0.3)'=5, 'S3: both true and noise latent variables are correlated(0.3)'=5)) %>%
kable_classic(full_width = F, html_font = "Cambria",lightable_options = c("hover"))%>%
row_spec(3,background = 'yellow') %>%
row_spec(4:6, background = 'pink') %>%
row_spec(7:8, background = 'lightblue') %>%
pack_rows("\n", 3,8) %>%
pack_rows("\n", 9,14) %>%
footnote(general = "Findings from the table",
number = c("more continuous variables are selected when use None standardization than that of other methods",
"among all standardizations, the selection rate of binary with percentage of one close to 0.9 is highest in the case of using Z-score",
"when use Min-max method, the multi-category variables have highest selection rates, compared to other approaches",
"the Proposed strategy has relative low variable sensitivity but highest variable specificity, and the fact that applying proposed standardization on real data gives highest AUC score and lowest BIC value implies that the proposed method is able to select most of the important features as well as filter out negative effects by ignoring most of the noise variables \n \n",
"variable sensitivity and specificity decreased for all mehtods in correlated case, but specificity of proposed method does not change much",
"in independent case, selection rate of multi-category variables tend to be lower than binary(0.5/0.7), in correlated case, selection rate of multi-category tend to be higher than binary(0.5/0.7)"))
tb_exp[-c(1,4),c(1:4,6)] %>%
as.data.frame() %>%
kbl(caption = 'latent exp distribution', format = "latex") %>%
kable_classic(full_width = F,lightable_options = c("hover"))%>%
row_spec(3,background = 'yellow') %>%
row_spec(4:6, background = 'pink') %>%
row_spec(7:8, background = 'lightblue') %>%
pack_rows("\n", 3,8) %>%
pack_rows("\n", 9,14)
tb_gamma[-c(1,4),c(1:4,6)] %>%
as.data.frame() %>%
kbl(caption = 'latent gamma distribution', bold=T) %>%
kable_classic(full_width = F,lightable_options = c("hover"))%>%
row_spec(3,background = 'yellow') %>%
row_spec(4:6, background = 'pink') %>%
row_spec(7:8, background = 'lightblue') %>%
pack_rows("\n", 3,8) %>%
pack_rows("\n", 9,14)
tb_exp[-c(1,4),c(1:4,6)] %>%
as.data.frame() %>%
kbl(caption = 'latent exp distribution', bold=T) %>%
kable_classic(full_width = F,lightable_options = c("hover"))%>%
row_spec(3,background = 'yellow') %>%
row_spec(4:6, background = 'pink') %>%
row_spec(7:8, background = 'lightblue') %>%
pack_rows("\n", 3,8) %>%
pack_rows("\n", 9,14)
tb_gamma[-c(1,4),c(1:4,6)] %>%
as.data.frame() %>%
kbl(caption = 'latent gamma distribution', bold=T) %>%
kable_classic(full_width = F, html_font = "Cambria",lightable_options = c("hover"))%>%
row_spec(3,background = 'yellow') %>%
row_spec(4:6, background = 'pink') %>%
row_spec(7:8, background = 'lightblue') %>%
pack_rows("\n", 3,8) %>%
pack_rows("\n", 9,14)
tb_exp[-c(1,4),c(1:4,6)] %>%
as.data.frame() %>%
kbl(caption = 'latent exp distribution', bold=T) %>%
kable_classic(full_width = F, html_font = "Cambria",lightable_options = c("hover"))%>%
row_spec(3,background = 'yellow') %>%
row_spec(4:6, background = 'pink') %>%
row_spec(7:8, background = 'lightblue') %>%
pack_rows("\n", 3,8) %>%
pack_rows("\n", 9,14)
